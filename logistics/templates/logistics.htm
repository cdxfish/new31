{% extends "office.base.htm" %}

{% block content %}
      <div class="search" nowrap="true" colspan="3">
          <form action="/order/" method="get">
            <select name="c">
              <option value="-1" selected>全部</option>
{% for v,i in oStatus %}
              <option value="{{ v }}" >{{ i }}</option>
{% endfor %}
            </select>
            <input type="text" name="s" size="7" value="{% if s %}{{ s }}{% else %}{% now "Y-m-d" %}{% endif %}" class="date">
             <span>至</span>
            <input type="text" name="e" size="7" value="{% if e %}{{ e }}{% else %}{% now "Y-m-d" %}{% endif %}" class="date">
            <input type="text" name="k" size="15" value="{{ k }}" />
            <input type="submit" value=" 搜索 " class="button" />
          </form>
      </div>
      <table cellpadding="3" cellspacing="1" width="100%" class="sortTable">
        <thead>
          <tr>
            <th>类型</th>
            <th>订单编号</th>
            <th>收货时间</th>
            <th>联系人</th>
            <th>金额</th>
            <th>预出货</th>
            <th>物流</th>
            <th>状态</th>
            <th>操作</th>
          </tr>
          </thead>
          <tbody>
{% for i in oList %}
          <tr align="center" class="tr_border_top_black">
            <td>{{ i.get_orderType_display }}</td>
            <td><a href="/order/{{ i.orderSn }}/">{{ i.orderSn }}</a></td>
            <td>{{ i.orderlogistics.signDate|date:"Y-m-d" }} | {{ i.orderlogistics.signTimeStart|time:"H:i" }} - {{ i.orderlogistics.signTimeEnd|time:"H:i" }}</td>
            <td>{{ i.orderlogistics.consignee }} [ {{ i.orderlogistics.tel }} ]</td>
            <td>189.00</td>
            <td>{{ i.orderlogistics.logisTimeStart|time:"H:i" }} - {{ i.orderlogistics.logisTimeEnd|time:"H:i" }} | {{ i.orderlogistics.get_advance_display }}</td>
            <td>吴</td>
            <td>{{ i.orderstatus.get_orderStatus_display }} | {{ i.orderpay.get_payStatus_display }} | {{ i.ordership.get_shipStatus_display }}</td>
            <td nowrap="nowrap">
{% for v,ii in i.action %}
           <a href="/logistics/ccon/{{ v }}/?sn={{ i.orderSn }}" class="button">{{ ii }}</a>
{% endfor %}
            </td>
          </tr>
{% for item in i.orderitem_set.all %}
          <tr align="center">
            <td align="right" nowrap="true" colspan="5">{{ item.name }}</td>
            <td>{{ item.spec }}</td>
            <td>{{ item.number }}</td>
            <td>未产</td>
            <td><a href="/a/" class="button">生产请求</a></td>
          </tr>
{% endfor %}
          <tr>
            <td align="center">地址</td>
            <td colspan="8"><a href="/map/?k={{ i.orderlogistics.address }}" target="_blank">{{ i.orderlogistics.address }}</a></td>
          </tr>          <tr>
            <td align="center">备注</td>
            <td colspan="8">速度送</td>
          </tr>
{% endfor %}
          </tbody>
          <tr>
            <td align="right" nowrap="true" colspan="11">
              总计 {{ oList.paginator.count }} 条记录，共 {{ oList.paginator.num_pages }} 页，当前第 {{ p }} 页
              <span id="pageLink">
                <a href="/order/?k={{ k }}&c={{ c }}&s={{ s }}&e={{ e }}&p=1">第一页</a>
{% if oList.has_previous %}
                <a href="/order/?k={{ k }}&c={{ c }}&s={{ s }}&e={{ e }}&p={{ oList.previous_page_number }}">上一页</a>
{% endif %}
{% if oList.has_next %}
                  <a href="/order/?k={{ k }}&c={{ c }}&s={{ s }}&e={{ e }}&p={{ oList.next_page_number }}">下一页</a>
{% endif %}
              </span>           
            </td>
          </tr>
      </table>
{% endblock %}